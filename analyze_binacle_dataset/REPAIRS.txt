#####
## Use following script to analyze small files first:
## 1. pick a small file from list of broken files
##   $> (for x in `cat BROKEN_FILES.txt | grep "not repaired" | cut -f1 -d' ' | cut -f1 -d\.`; do name="sources/$x.Dockerfile"; wc -l $name; done) | sort -n
##
##  or from the original dataset (notice there is a lot of empty files and one-liners):
##   $> gedit sortedlist-dockerfiles.txt
##
## 2. run the following script to create dir for Dockerfile and run docker build on it
##   $> FILE=sources/484144517.Dockerfile
##   $> ID=$(basename $FILE | cut -f1 -d\.); mkdir -p $ID; (cd $ID; cp ../$FILE Dockerfile; docker build -t binacle:$ID . 2>&1 | tee log.txt)
##
## 3. to rerun a docker after updating Dockerfile (to diagnose)
##   $> docker build -t binacle:$ID . 2>&1 | tee log.txt
##
####

483357603
  Error message: "useradd: UID 1000 is not unique"
  Diagnosis: "A variable needed to be changed before using the Dockerfile"
  Repair: "Change value of variable PERM_USER_ID from 1000 to 1001 at line 4"
  Source: "https://github.com/nodejs/docker-node/issues/289"
  Hadolint: "Two warnings, but none related."

483202780
  Error message: "No package mingw32-[binutils,crt,nsis] available"
  Diagnosis: "yum cannot find requested package, this package are no longer supported by the OS"
  Repair: "There are no repairs available"
  Source: "https://forums.centos.org/viewtopic.php?t=68772","https://unix.stackexchange.com/questions/327156/where-can-i-find-and-install-the-mingw-w64-packages-for-centos-7"
  Hadolint: "Several warnings, but none related."

484144517
  Error message: apt-get: comand not found
  Diagnosis: "The openjdk:latest image is derived from Alpine"
  Repair: "FROM openjdk:12-jdk-oraclelinux7 at line 1", "RUN bash - && yum -y install nodej at line 3"
  Source: "https://forums.docker.com/t/openjdk-bin-sh-apt-command-not-found/72606", "https://deb.nodesource.com/setup_9.x"
  Hadolint: "Olny 1 warnig, Set the SHELL option -o pipefail before RUN with a pipe in it at line 3"

483733309
  Error message: "Operation failed: No such file or directory. The command '/bin/sh -c systemctl enable libvirtd' returned a non-zero code: 1" 
  Diagnosis: "There is no systemd-daemon running in the container, use a image that comes with systemd"
  Repair: "FROM unop/fedora-systemd at line 1" 
  Source: "https://github.com/geerlingguy/docker-fedora27-ansible/issues/2", "https://hub.docker.com/r/unop/fedora-systemd/"
  Hadolint: "Always tag the version of an image explicitly at line 1"

154176094
  Error message: "The repository 'http://security.ubuntu.com/ubuntu artful-security Release' does not have a Release file."
  Diagnosis: "The 17.04 repositories have been closed and withdrawn, use a newer image version"
  Repair: "FROM ubuntu:18.04 at line 2"
  Source: https://ubuntuforums.org/showthread.php?t=2382832
  Hadolint: "Several warnings, but none related."

169561074
  Error message: "gpg: no valid OpenPGP data found."
  Diagnosis: "Dockerfile using broken links to install/dowload/configure"
  Repair: "Add # at the beginning of lines 9 and 12"
  Source: "https://2019.www.torproject.org/docs/debian.html.en"
  Hadolint: "echo may not expand escape sequences. Use printf. at line 9"

176578348
  Error message: "E: Some index files failed to download. They have been ignored, or old ones used instead."
  Diagnosis: "Using older version of Ubuntu"
  Repair: "FROM ubuntu:18.04 at line 2"
  Source: https://askubuntu.com/questions/329450/e-some-index-files-failed-to-download-they-have-been-ignored-or-old-ones-used
  Hadolint: "Several warnings, but none related."

180704908
  Error message: "E: Unable to locate package libboost1.55-all-dev"
  Diagnosis: "libboost1.55-all-dev not found in the apt repository at line 12"
  Repair: "Change value from libboost1.55-all-dev to libboost-all-dev"
  Sourece: "https://askubuntu.com/questions/806478/xenial-16-04-cannot-find-package-libboost-all-dev"
  Hadolint: "Pin versions in apt get install. Instead of `apt-get install <package>` use `apt-get install <package>=<version>` at line 12", "The fix, is ​​to do the opposite of what the lint suggests"

185296869
  Error message: "pull access denied for freeradius/debian8-deps, repository does not exist or may require 'docker login': denied: requested access to the resource is denied"
  Diagnosis: "Using a non existent dockerhub image at line 1"
  Repair: "ARG from=debian:jessie"
  Sourece: "https://hub.docker.com/_/debian?tab=tags&page=1&name=jessie"
  Hadolint: "Line 1 Always tag the version of an image explicitly"

282262279
  Error message: "manifest for base/archlinux:latest not found: manifest unknown: manifest unknown"
  Diagnosis: "Obsolete name for docker image at line 1"
  Repair: "FROM archlinux/base"
  Sourece: "https://hub.docker.com/r/base/archlinux/"
  Hadolint:  "Line 1 warning to Always tag the version of an image explicitly"

286707117
  Error message: "Error message: ERROR: Could not open requirements file: [Errno 2] No such file or directory: 'requirements.txt'"
  Diagnosis: "The developer trying to copy a file out of a context at line 7"
  Repair: "There are no repairs available"
  Sourece: "https://stackoverflow.com/questions/55826941/run-pip-install-r-requirements-txt-not-working"
  Hadolint: "Use 'cd ... || exit' or 'cd ... || return' in case cd fails. at line 7"

317341044
  Error message: "pull access denied for docker-base-image, repository does not exist or may require 'docker login': denied: requested access to the resource is denied"
  Diagnosis: "Using a non existent docker image at line "
  Repair: "FROM openjdk:oraclelinux7"
  Sourece: "https://hub.docker.com/_/openjdk"
  Hadolint: "Always tag the version of an image explicitly at line 1"

320733641
  Message error: "E: The repository 'http://archive.ubuntu.com/ubuntu artful-backports Release' does not have a Release file."
  Diagnosis: "Ubuntu 17.04 reached End of Life last week. Time to upgrade to 18.04"
  Repair: "FROM ubuntu:18.04 at line 1"
  Source: "https://ubuntuforums.org/showthread.php?t=2382832"
  Hadolint: "Few warnings but not related with repair"

323821268
    Message error: "pull access denied for frolvlad/alpine-oraclejdk8, repository does not exist or may require 'docker login': denied: requested access to the resource is denied"
    Diagnosis: "Incorrect docker image name"
    Repair: "FROM frolvlad/alpine-java at line 1"
    Source: "https://hub.docker.com/r/frolvlad/alpine-oraclejre8"
    Hadolint: "Only 1 warning but not related"
